{
	"name": "Create Tables",
	"properties": {
		"content": {
			"query": "CREATE TABLE [dbo].[DimBattalion] (\n      battalion_id INT NOT NULL\n    , battalion_code VARCHAR(3) NOT NULL\n    , battalion_name VARCHAR(100) NULL\n    , battalion_city_id_fk INT NOT NULL DEFAULT(1)\n    , battalion_amount_of_members INT DEFAULT(5)\n    , is_active BIT NOT NULL DEFAULT(1)\n    , deactivation_date DATETIME NULL\n    , deactivation_reason VARCHAR(200) NULL\n)WITH\n(   CLUSTERED COLUMNSTORE INDEX\n,  DISTRIBUTION = HASH([battalion_code])\n)\n\nCREATE TABLE dbo.DimAction (\n      action_id INT NOT NULL\n\t, action_code varchar(5) NOT NULL\n    , action_name VARCHAR(100) NOT NULL\n    , action_description VARCHAR(500) NULL\n    , is_active BIT NOT NULL DEFAULT(1)\n    , deactivation_date DATETIME NULL\n    , deactivation_reason VARCHAR(200) NULL\n)WITH\n(   CLUSTERED COLUMNSTORE INDEX\n,  DISTRIBUTION = HASH([action_code])\n)\n\nCREATE TABLE dbo.DimSituation (\n      situation_id INT IDENTITY(1,1) NOT NULL\n    , situation_name VARCHAR(100) NOT NULL\n    , situation_description VARCHAR(500) NULL\n    , is_active BIT NOT NULL DEFAULT(1)\n    , deactivation_date DATETIME NULL\n    , deactivation_reason VARCHAR(200) NULL\n)\n\n\nCREATE TABLE dbo.DimPropertyUse (\n      property_use_id INT IDENTITY(1,1) NOT NULL\n    , property_use_name VARCHAR(100) NOT NULL\n    , property_use_description VARCHAR(500) NULL\n    , is_active BIT NOT NULL DEFAULT(1)\n    , deactivation_date DATETIME NULL\n    , deactivation_reason VARCHAR(200) NULL\n)\n\nCREATE TABLE dbo.DimAreaOfFireOrigin (\n      area_id INT NULL\n    , area_code varchar(3) NOT NULL\n    , area_name VARCHAR(100) NOT NULL\n    , area_description VARCHAR(500) NULL\n    , is_active BIT NOT NULL DEFAULT(1)\n    , deactivation_date DATETIME NULL\n    , deactivation_reason VARCHAR(200) NULL\n)WITH\n(   CLUSTERED COLUMNSTORE INDEX\n,  DISTRIBUTION = HASH([area_code])\n)\n\n\nCREATE TABLE dbo.DimDistrict (\n      district_id INT NOT NULL\n    , district_name VARCHAR(100) NOT NULL\n    , district_city_id_fk INT NOT NULL DEFAULT(1)\n    , district_location_latitude DECIMAL(10,2) NULL\n    , district_location_longitude DECIMAL(10,2) NULL\n    , is_active BIT NOT NULL DEFAULT(1)\n    , deactivation_date DATETIME NULL\n    , deactivation_reason VARCHAR(200) NULL\n)WITH\n(   CLUSTERED COLUMNSTORE INDEX\n,  DISTRIBUTION = HASH([district_id])\n)\n\n\nCOPY INTO dbo.Raw_FireIncidents\n FROM 'https://sablobfiles.dfs.core.windows.net/externaldata/dailyFires/202110/20211027_Fires_Raw_Data.json'\n WITH (\n\tFILE_TYPE = 'CSV',\n    CREDENTIAL = (IDENTITY = 'Managed Identity'),\n\tFIELDTERMINATOR ='0x0b',\n\tROWTERMINATOR = '0x0b'\n );\n\nCREATE EXTERNAL TABLE dbo.Raw_FireIncidents (\n\tincident_number INT\n\t,exposure_number INT\n\t,id VARCHAR (50)\n\t,address VARCHAR (500)\n\t,incident_date DATE\n\t,call_number VARCHAR (50)\n\t,alarm_dttm DATETIME\n\t,arrival_dttm DATETIME\n\t,close_dttm DATETIME\n\t,city VARCHAR (50)\n\t,zipcode VARCHAR (50)\n\t,battalion VARCHAR (50)\n\t,station_area VARCHAR (50)\n\t,box VARCHAR (50)\n\t,suppression_units INT\n\t,suppression_personnel INT\n\t,ems_units INT\n\t,ems_personnel INT\n\t,other_units INT\n\t,other_personnel INT\n\t,first_unit_on_scene VARCHAR (50)\n\t,estimated_property_loss INT\n\t,estimated_contents_loss INT\n\t,fire_fatalities INT\n\t,fire_injuries INT\n\t,civilian_fatalities INT\n\t,civilian_injuries INT\n\t,number_of_alarms INT\n\t,primary_situation VARCHAR (500)\n\t,mutual_aid VARCHAR (500)\n\t,action_taken_primary VARCHAR (500)\n\t,action_taken_secondary VARCHAR (500)\n\t,action_taken_other VARCHAR (500)\n\t,detector_alerted_occupants VARCHAR (50)\n\t,property_use VARCHAR (500)\n\t,area_of_fire_origin VARCHAR (500)\n\t,ignition_cause VARCHAR (500)\n\t,ignition_factor_primary VARCHAR (500)\n\t,ignition_factor_secondary VARCHAR (500)\n\t,heat_source VARCHAR (500)\n\t,item_first_ignited VARCHAR (500)\n\t,human_factors_associated_with_ignition VARCHAR (500)\n\t,structure_type VARCHAR (500)\n\t,structure_status VARCHAR (500)\n\t,floor_of_fire_origin INT\n\t,fire_spread VARCHAR (50)\n\t,no_flame_spead VARCHAR (50)\n\t,number_of_floors_with_minimum_damage INT\n\t,number_of_floors_with_significant_damage INT\n\t,number_of_floors_with_heavy_damage INT\n\t,number_of_floors_with_extreme_damage INT\n\t,detectors_present VARCHAR (50)\n\t,detector_type VARCHAR (50)\n\t,detector_operation VARCHAR (50)\n\t,detector_effectiveness VARCHAR (50)\n\t,detector_failure_reason VARCHAR (50)\n\t,automatic_extinguishing_system_present VARCHAR (50)\n\t,automatic_extinguishing_sytem_type VARCHAR (50)\n\t,automatic_extinguishing_sytem_perfomance VARCHAR (50)\n\t,automatic_extinguishing_sytem_failure_reason VARCHAR (50)\n\t,number_of_sprinkler_heads_operating INT\n\t,supervisor_district VARCHAR (50)\n\t,neighborhood_district VARCHAR (50)\n)WITH (\n    LOCATION='../userdata1.parquet',\n    DATA_SOURCE = AzureStorageAccount,\n    FILE_FORMAT=parquet_file_format\n);\n\nCREATE TABLE dbo.FactFireIncidents (\n\tincident_number INT  NOT NULL\n\t, exposure_number INT  NOT NULL\n\t, id VARCHAR (50)  NOT NULL\n\t, address VARCHAR (500)  NOT NULL\n\t, incident_date DATE NULL\n\t, call_number VARCHAR (50) NULL\n\t, alarm_dttm DATETIME NULL\n\t, arrival_dttm DATETIME NULL\n\t, close_dttm DATETIME NULL\n\t, city VARCHAR (50) NULL\n\t, zipcode VARCHAR (50) NULL\n\t, battalion_id_fk INT  NOT NULL\n\t, station_area VARCHAR (50) NULL\n\t, box VARCHAR (50) NULL\n\t, suppression_units INT NULL\n\t, suppression_personnel INT NULL\n\t, ems_units INT NULL\n\t, ems_personnel INT NULL\n\t, other_units INT NULL\n\t, other_personnel INT NULL\n\t, first_unit_on_scene VARCHAR (50) NULL\n\t, estimated_property_loss INT NULL\n\t, estimated_contents_loss INT NULL\n\t, fire_fatalities INT NULL\n\t, fire_injuries INT NULL\n\t, civilian_fatalities INT NULL\n\t, civilian_injuries INT NULL\n\t, number_of_alarms INT NULL\n\t, primary_situation VARCHAR(500) NULL\n\t, mutual_aid VARCHAR (500) NULL\n\t, action_taken_primary_id_fk INT NULL\n\t, action_taken_secondary_id_fk INT NULL\n\t, action_taken_other VARCHAR (500) NULL\n\t, detector_alerted_occupants VARCHAR (50) NULL\n\t, property_use VARCHAR(500) NULL\n\t, area_of_fire_origin_id_fk INT NULL\n\t, ignition_cause VARCHAR (500) NULL\n\t, ignition_factor_primary VARCHAR (500) NULL\n\t, ignition_factor_secondary VARCHAR (500) NULL\n\t, heat_source VARCHAR (500) NULL\n\t, item_first_ignited VARCHAR (500) NULL\n\t, human_factors_associated_with_ignition VARCHAR (500) NULL\n\t, structure_type VARCHAR (500) NULL\n\t, structure_status VARCHAR (500) NULL\n\t, floor_of_fire_origin INT NULL\n\t, fire_spread VARCHAR (50) NULL\n\t, no_flame_spead VARCHAR (50) NULL\n\t, number_of_floors_with_minimum_damage INT NULL\n\t, number_of_floors_with_significant_damage INT NULL\n\t, number_of_floors_with_heavy_damage INT NULL\n\t, number_of_floors_with_extreme_damage INT NULL\n\t, detectors_present VARCHAR (50) NULL\n\t, detector_type VARCHAR (50) NULL\n\t, detector_operation VARCHAR (50) NULL\n\t, detector_effectiveness VARCHAR (50) NULL\n\t, detector_failure_reason VARCHAR (50) NULL\n\t, automatic_extinguishing_system_present VARCHAR (50) NULL\n\t, automatic_extinguishing_sytem_type VARCHAR (50) NULL\n\t, automatic_extinguishing_sytem_perfomance VARCHAR (50) NULL\n\t, automatic_extinguishing_sytem_failure_reason VARCHAR (50) NULL\n\t, number_of_sprinkler_heads_operating INT NULL\n\t, supervisor_district VARCHAR (500) NULL\n\t, neighborhood_district_id_fk INT NULL\n)WITH\n(   CLUSTERED COLUMNSTORE INDEX\n,  DISTRIBUTION = HASH([incident_number])\n)\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SQLPoolTest",
				"poolName": "SQLPoolTest"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}